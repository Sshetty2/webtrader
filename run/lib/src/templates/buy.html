{% extends "structure_logged.html" %}
{% block main %}

<script>
        $('#myBtn').on('submit', function(e){
          $('#myModal').modal('show');
          e.preventDefault();
        });
</script>

<div>
        <video autoplay muted loop style="width:100%; height:100%">
            <source id="mp4" src="/static/bullbear.mp4" type="video/mp4"/>
            <p>Your user agent does not support the HTML5 Video element.</p>
        </video>
            <div class="bg_content">    
                <form action="/buy" method="post" onsubmit="openModal()" id="myForm" class="form-signin">
                    <!-- <h1 class="h3 mb-3 font-weight-normal">Buy Shares</h1> -->
                    <!-- <img src="/static/Squirtle.png" img class = "center" alt="Squirtle" width="300" height="200"> -->
                    {% with messages = get_flashed_messages() %}
                        {% if messages %}
                            {% for message in messages %}
                                <h4>{{message}}</h4>
                            {% endfor %}
                        {% endif %}
                    {% endwith %}
                    <h4>Enter the ticker symbol of the stock you'd like to purchase:</h4>
                    <input name="ticker_symbol" id="ticker_symbol" type="text" class="form-control" style="width: 95%" margin = "margin: 6px" placeholder="Ticker Symbol" required = "True" autofocus"">
                    <h4>Enter the number of shares you'd like to purchase:</h4>
                    <input name="number_of_shares" id="number_of_shares" type="text" class="form-control" style="width: 95%" margin = "margin: 6px" placeholder="Number of Shares" required = "True"  autofocus"">
                    <button class="btn btn-info btn-lg" id= "myBtn"  type="submit">Buy</button>
                </form>
                    <div class="modal fade" tabindex="-1" role="dialog" id="myModal">   
                        <div class="modal-dialog" role="document">
                              <!-- Modal content-->
                              <div class="modal-content" style="rgba(0, 0, 0, 0.5)">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                </div>
                                <div class="modal-body">
                                  <p id= "demo">Some text in the modal.</p>
                                </div>

                                <div class="modal-footer">
                                         <span>Confirm?</span>
                                    <button type="button" class="btn btn-default" data-dismiss="modal">
                                            <span class="glyphicon glyphicon-home"></span> Yes
                                    </button>
                                    <button type="button" class="btn btn-default" data-dismiss="modal">No</button>
                                </div>

                              </div>
                         </div>
                    </div>
            </div>
</div> 

<script>
function openModal(){
    var ticker_symbol = $('#ticker_symbol').val();
    var number_of_shares = $('#number_of_shares').val();


    var https = require('https');

    var request = https.request({
        method: "GET",
        host: "api.intrinio.com",
        path: `/companies?ticker=${ticker_symbol}&api_key=OjRkY2Y3Y2UxNjkwNTYxZmI1YjJjY2IyMDRlODIyYWMy`
    }, function(response) {
        var json = "";
        response.on('data', function (chunk) {
            json += chunk;
        });
        response.on('end', function() {
            var company = JSON.parse(json);
            console.log(company);
        });
    });

//     var IntrinioClient = require('intrinio');
    
//     intrinio.ApiClient.instance.authentications['ApiKeyAuth'].apiKey = "YOUR API KEY";
    
//     var company_api = new IntrinioClient.CompanyApi()
    
//     company_api.getAllCompanies().then(function(data) {
//     console.log('API called successfully. Returned data: ' + data);
//     }, function(error) {
//     console.error(error);
//     });

    
//     request.end();
    
    document.getElementById("demo").innerHTML = "Hello World";

}



</script>


{% endblock main %}